scalar DateTime
  @scalar(class: "Nuwave\\Lighthouse\\Schema\\Types\\Scalars\\DateTime")
scalar JSON @scalar(class: "Narsil\\GraphQL\\Scalars\\JSON")

extend type Query {
  block(id: ID! @eq): Block @find
  blocks: [Block!]! @all
	entity(id: ID! @eq): Entity @find
  entities: [Entity!]! @all
  field(id: ID! @eq): Field @find
  fields: [Field!]! @all
	fieldset(id: ID! @eq): Fieldset @find
  fieldsets: [Fieldset!]! @all
	form(id: ID! @eq): Form @find
  forms: [Form!]! @all
	input(id: ID! @eq): Input @find
  inputs: [Input!]! @all
  permission(id: ID! @eq): Permission @find
  permissions: [Permission!]! @all
  role(id: ID! @eq): Role @find
  roles: [Role!]! @all
  template(id: ID! @eq): Template @find
  templates: [Template!]! @all
  user(id: ID! @eq): User @find
  users: [User!]! @all
}

type Block @model(class: "Narsil\\Models\\Structures\\Block") {
  id: ID!
  collapsible: Boolean!
  handle: String!
  name: String!
  created_at: DateTime!
  updated_at: DateTime!
  blocks: [Block!]! @morphToMany
  elements: [BlockElement!]! @hasMany
  fields: [Field!]! @morphToMany
}

type BlockElement @model(class: "Narsil\\Models\\Structures\\BlockElement") {
  uuid: String!
  block_id: ID!
  description: String
  element_id: ID!
  element_type: String!
  field_id: ID!
  handle: String
  name: String
  owner_id: ID!
  position: Int!
  required: Boolean!
  translatable: Boolean!
  width: Int!
	owner: Block! @belongsTo
  block: Block! @belongsTo
  conditions: [BlockElementCondition!]! @hasMany
  field: Field! @belongsTo
}

type BlockElementCondition @model(class: "Narsil\\Models\\Structures\\BlockElementCondition") {
  uuid: String!
  block_element_uuid: String!
  handle: String!
  operator: String!
  value: String
	block_element: BlockElement! @belongsTo
}

type Entity @model(class: "Narsil\\Models\\Entities\\Entity") {
  uuid: String!
  id: ID!
	published_from: DateTime
	published_to: DateTime
	published: Boolean!
	revision: Int!
	slug: String!
	template_id: ID!
  target_uuid: String!
	created_at: DateTime!
	updated_at: DateTime!
	deleted_at: DateTime
	template: Template! @belongsTo
}

type EntityNode @model(class: "Narsil\\Models\\Entities\\EntityNode") {
  uuid: String!
	element_type: String!
	entity_block_uuid: String
	entity_uuid: String!
	value: String!
  element_id: String!
	blocks: [EntityNode!]! @hasMany
	element: HasElement! @morphTo
	entities: [Entity!]! @belongsToMany
	entity_block: EntityNode! @belongsTo
	entity: Entity! @belongsTo
	form: [Form!]! @belongsToMany
}

type EntityNodeEntity @model(class: "Narsil\\Models\\Entities\\EntityNodeEntity") {
  uuid: String!
  entity_uuid: String!
  entity_node_uuid: String!
	entity: Entity! @belongsTo
  entity_node: EntityNode! @belongsTo
}

type EntityNodeForm @model(class: "Narsil\\Models\\Entities\\EntityNodeForm") {
  uuid: String!
  entity_node_uuid: String!
  form_id: ID!
  entity_node: EntityNode! @belongsTo
  form: Form! @belongsTo
}

type Field @model(class: "Narsil\\Models\\Structures\\Field") {
  id: ID!
	class_name: String
	required: Boolean!
	type: String!
  description: String
  handle: String!
  name: String!
  settings: String
  translatable: Boolean!
  type: String!
  created_at: DateTime!
  updated_at: DateTime!
  blocks: [Block!]! @belongsToMany
  options: [FieldOption!]! @hasMany
	validation_rules: [ValidationRule!]! @belongsToMany
}

type FieldBlock @model(class: "Narsil\\Models\\Structures\\FieldBlock") {
  uuid: String!
	block_id: ID!
  field_id: ID!
  block: Block! @belongsTo
	field: Field! @belongsTo
}

type FieldOption @model(class: "Narsil\\Models\\Structures\\FieldOption") {
  uuid: String!
  field_id: ID!
  label: String!
  position: Int!
  value: String!
  created_at: DateTime!
  updated_at: DateTime!
	field: Field! @belongsTo
}


type Fieldset @model(class: "Narsil\\Models\\Forms\\Fieldset") {
  id: ID!
  handle: String!
  name: String!
  created_at: DateTime!
  updated_at: DateTime!
  fielsets: [Fieldset!]! @morphToMany
  elements: [BlockElement!]! @hasMany
  inputs: [Input!]! @morphToMany
}

type FieldsetElement @model(class: "Narsil\\Models\\Forms\\FieldsetElement") {
  uuid: String!
  description: String
  element_id: ID!
  element_type: String!
  fieldset_id: ID!
  handle: String
  input_id: ID!
  name: String
  owner_id: ID!
  position: Int!
  required: Boolean!
  width: Int!
	owner: Fieldset! @belongsTo
  conditions: [FieldsetElementCondition!]! @hasMany
  fieldset: Fieldset! @belongsTo
  input: Input! @belongsTo
}

type FieldsetElementCondition @model(class: "Narsil\\Models\\Forms\\FieldsetElementCondition") {
  uuid: String!
  fieldset_element_uuid: String!
  handle: String!
  operator: String!
  value: String
	fieldset_element: FieldsetElement! @belongsTo
}

type FieldValidationRule @model(class: "Narsil\\Models\\Structures\\FieldValidationRule") {
  uuid: ID!
  field_id: ID!
  validarion_rule_id: ID!
	field: Field! @belongsTo
  validation_rule: ValidationRule! @belongsTo
}

type Form @model(class: "Narsil\\Models\\Forms\\Form") {
  id: ID!
	title: String!
  description: String!
  handle: String!
  created_at: DateTime!
  updated_at: DateTime!
}

type FormTab @model(class: "Narsil\\Models\\Forms\\FormTab") {
  uuid: ID!
  form_id: ID!
  handle: String!
  name: String!
  position: Int!
  created_at: DateTime!
  updated_at: DateTime!
  fieldsets: [Fieldset!]! @morphToMany
  elements: [TemplateTabElement!]! @hasMany
  inputs: [Input!]! @morphToMany
  form: Form! @belongsTo
}

type FormTabElement @model(class: "Narsil\\Models\\Forms\\FormTabElement") {
  uuid: String!
  description: String
  element_id: ID!
  element_type: String!
  fieldset_id: ID!
  handle: String
  input_id: ID!
  name: String
  owner_uuid: String!
  position: Int!
  required: Boolean!
  width: Int!
	owner: FormTab! @belongsTo
  conditions: [FormTabElementCondition!]! @hasMany
  fieldset: Fieldset! @belongsTo
  input: Input! @belongsTo
}

type FormTabElementCondition @model(class: "Narsil\\Models\\Forms\\FormTabElementCondition") {
  uuid: String!
  form_tab_element_uuid: String!
  handle: String!
  operator: String!
  value: String
	form_tab_element: FormTabElement! @belongsTo
}

type Input @model(class: "Narsil\\Models\\Forms\\Input") {
  id: ID!
	required: Boolean!
	type: String!
  description: String
  handle: String!
  name: String!
  settings: String
  type: String!
  created_at: DateTime!
  updated_at: DateTime!
  options: [InputOption!]! @hasMany
	validation_rules: [ValidationRule!]! @belongsToMany
}

type InputOption @model(class: "Narsil\\Models\\Forms\\InputOption") {
  uuid: String!
  input_id: ID!
  label: String!
  position: Int!
  value: String!
  created_at: DateTime!
  updated_at: DateTime!
	input: Input! @belongsTo
}

type InputValidationRule @model(class: "Narsil\\Models\\Forms\\InputValidationRule") {
  uuid: ID!
  input_id: ID!
  validarion_rule_id: ID!
	input: Input! @belongsTo
  validation_rule: ValidationRule! @belongsTo
}

type Permission @model(class: "Narsil\\Models\\Policies\\Permission") {
  id: ID!
  handle: String!
  name: String!
  created_at: DateTime!
  updated_at: DateTime!
  roles: [Role!]! @belongsToMany
}

type Role @model(class: "Narsil\\Models\\Policies\\Role") {
  id: ID!
	handle: String!
  name: String!
  created_at: DateTime!
  updated_at: DateTime!
  permissions: [Permission!]! @belongsToMany
}

type RolePermission @model(class: "Narsil\\Models\\Policies\\RolePermission") {
  uuid: String!
	permission_id: ID!
  role_id: ID!
  permission: Permission! @belongsTo
	role: Role! @belongsTo
}

type Template @model(class: "Narsil\\Models\\Structures\\Template") {
  id: ID!
  handle: String!
	plural: String!
  singular: String!
  created_at: DateTime!
  updated_at: DateTime!
}

type TemplateTab @model(class: "Narsil\\Models\\Structures\\TemplateTab") {
  uuid: ID!
  handle: String!
  name: String!
  position: Int!
  template_id: ID!
  created_at: DateTime!
  updated_at: DateTime!
  blocks: [Block!]! @morphToMany
  elements: [TemplateTabElement!]! @hasMany
  fields: [Field!]! @morphToMany
  template: Template! @belongsTo
}

type TemplateTabElement @model(class: "Narsil\\Models\\Structures\\TemplateTabElement") {
  uuid: String!
  block_id: ID!
  description: String
  element_id: ID!
  element_type: String!
  field_id: ID!
  handle: String
  name: String
  owner_uuid: String!
  position: Int!
  required: Boolean!
  translatable: Boolean!
  width: Int!
	owner: TemplateTab! @belongsTo
  block: Block! @belongsTo
  conditions: [TemplateTabElementCondition!]! @hasMany
  field: Field! @belongsTo
}

type TemplateTabElementCondition @model(class: "Narsil\\Models\\Structures\\TemplateTabElementCondition") {
  uuid: String!
  template_tab_element_uuid: String!
  handle: String!
  operator: String!
  value: String
	template_tab_element: TemplateTabElement! @belongsTo
}

type User @model(class: "Narsil\\Models\\User") {
  id: ID!
  avatar: String
  first_name: String
  full_name: String
  last_name: String
  email: String!
  created_at: DateTime!
  updated_at: DateTime!
  permissions: [Permission!]! @belongsToMany
  roles: [Role!]! @belongsToMany
}

type ValidationRule @model(class: "Narsil\\Models\\User") {
  id: ID!
  handle: String!
}

union Element = Block | Field | Fieldset | Input

union HasElement = BlockElement | TemplateTabElement
